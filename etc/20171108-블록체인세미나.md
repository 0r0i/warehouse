

- 이더리움은 AWS의 람다와 유사하다


- account, tx, receipt가 모두 블록에 들어간다.
- tx와 receipt의 트리와 status(자주 변경됨)의 트리(머클 패트리샤)는 구조가 다르다.

- 머클 트리는 해쉬 재계산 회수를 줄이는 게 목적

- 패트리샤는 트리 깊이 한정 가능. 노드 경로 명시 가능


- bloom filter는 receipt 빨리 찾는 용도

- 

- ethash
- 이더리움 PoW
- CPU보다 메모리IO 중심으로 소모하도록
- 현재 ethash로 PoW 실행되고 있음

- 5G는 대역폭이 남는다
- p2p가 다시 빛을 볼 수도..

## 컨센서스 알고리듬

- 로드밸런서 도입 그림 좋다
- 마스터-슬레이브 디비 그림 좋다
- 리플리카

- Statemachine replica, Leader selection, atomic broadcasting

- bitcoin's academic pedigree

### BFT

- 비잔틴 장군 문제
- 노드는 req를 전파받으면 처리 후 클라이언트에 직접 응답
- 1 + 1/3의 응답이 오면 합의
- 2phase 프로토콜
  - p1, 변조 없다 합의
  - p2, 요청이 정상 실행되어 반환 했다 합의
- checkpoint로 주기적 스냅샷을 찍어서 checkpoint도 리플리카에 보내서 합의
- 합의되면 state와 digest로 남기고 과거분은 삭제
- View(primary?) 변경 시에도 리플리카끼리 메시지를 주고 받으며 합의

### PoS와 게임 이론

- POS
  - chain based : 일정 시간 기준 지분 비례로 validator 선정, 한 블록 안에서 끝나야 된다. Sync
  - BFT 스타일: 타임 바운드 없이 여러 블록에 걸쳐서 합의 끝난다. Async
  - 이더리움: BFT 스타일 + 게임이론에 의한 경제적 페널티, 51% 공격시 PoW에 비해 더 비싼 대가를 치르게 만든다.

- PoW 대비 장점
  - PoW 풀지 않아 자원 절약
  - 블록 생성 속도 빨라짐

- Noting at Stake
  - 두 체인 모두에 투표를 하면 기대값이 1
  - 양쪽에 투표하면 감점 효과 도입, 예치금 일부 소각

- Casper
  - 클라이언트가 없고 모두가 레플리카, 따라서 PRE-PREPARE 메시지는 없다.
  - 나머지는 PBFT와 유사
  - 100번째 블록마다 Epoch라는 checkpoint 생성
  - PoW 가 공존하다가 점진적으로 걷어냄

### DPoS

- 대리인에게 투표
- 일정한 수 대리인 선출
- 대리인은 득표수에 비례해서 블록 생성 권한
- 대리인은 거버넌스 권한
- 대리인이 투표로 대리인을 해고
- 1시간
- 투표권자는 다른 투표권자에게 투표권 이양 가능
- 그래핀 계열
- 포크 위험이 낮고
- 토큰 양에 비례한 사용 대역폭
- 대리인 담합
- 대리인 집중
- DDoS 위험
- 대리인 구금 등

## 보안

- 스마트 컨트랙의 콜백 함수를 이용

### DAO Attack

- Reentrancy Attack
- 수금자가 컨트랙, 컨트랙이 다시 송금자 함수를 호출, 다시 송금, 컨트랙 수금, 다시 송금자 호출.. 로 돈이 줄줄..

- send, call, transfer
- send를 쓰면 가스가 없어서 다시 송금자 함수 호출 불가

### DoS Attack

- 경매 코드
- 리더가 바뀌어서 기존 리더에게 입찰금을 반환해주도록 코딩되어 있음
- 작은 금액으로 입찰하고, 반환받는 코드에서 예외를 던지도록 하면, 다른 사람이 더 높은 금액으로 입찰해도 리더가 바뀔 수 없음
- 자동 반환이 아니라, 경매 종료 후 수금해가도록

### Timestamp Dependence

- 마이너가 타임스탬프를 바꿀 수 있다?
- now 같은 변수를 쓰면 안된다
- 그냥 랜덤은 얻기 어렵다. 뭔가 크립토하게 어렵게 생성해야 마이너의 영향을 받지 ㅇ낳을 수 있다.
- 카지노 사이트에서 대가리 굴리고 있음

## 보안

- 서킷 브레이커
  - Pausable: 사고가 나면 실행이 멈출 수 있도록
- Rate limiting
  - 출금 한도
- 
- 보안 조치를 하면 보안 코드 자체도 위험 내포, 보안 조치에는 가스 소요, 가스를 계약 작성자가 아니라 계약 사용자가 납부

## 보안 조치

- SMTChecker
  - 컴파일 단계에서 Overflow 등 경고 처리

- Security Auditing
  - 코드 리뷰를 통한 감사 보고
  - 버그 바운티
  - 1주일에 5만불 오오~~

## 보안 도구

- Solium
  - linting
  - security plugin
- Solhint
  - Solium 과 비슷
- solidity language support
  - VS 플러그인
- Oyente
  - 바이트코드 수준에서 검사

- 앱마다 블록체인을 만드는게 좋다
- 새로 만들긴 어려우니 사이드 체인으로..
- 커스텀 가능한 블록체인을 만들어 올리는 프로젝트

---
# dApp 개발 사례

- Mist: 이더리움 노드가 동작하는 브라우저
- IPFS: 위변조가 불가능한 머클 주소 베이스드 파일 공유 시스템
  - 사진 등 메타데이터는 IPFS에 저장
  - 스마트계약에서 IPFS에 저장된 이미지의 해쉬를 써서 위변조 되지 않음을 확인 가능
- pouchdb: 클라이언트 단 HTML5 DB 캐쉬

- 메타마스크만 설치된 브라우저에서 일반 사용자도 사용 가능하도록
- 실물 화폐 페그된 코인 사용
- 사이드 체인에서 계약 체결되게 해서 속도 확보
- 사이드 체인 서버(매칭)가 중앙화?
- 사이드 체인 블록은 물리적으로 IPFS에 저장
- 중앙화와 차이는 계좌가 실제 내 계좌다

---
# 패널 토의

## 이더리움의 성숙도

- 박재현
  - 비탈릭 오리엔티드 개발
  - 2~3년은 있어야 개발 관점에서도 활성화
- 해쉬라운드
  - 혀재 dapp을 브라우저에 올려서 또는 미스트로 실 서비스는 무리
  - solidity 자체가 위험
  - 리얼 타임 접근은 아예 포기 또는 다르게 사용
- 서광열
  - 거버넌스가 부족, 이더리움도 포크 되고 산모 역할을 하고 사라질수도..
- 요세미티
  - 사이드 체인으로 계층화

## 스테이블 코인

- 요세미티
- 단순한 USDT 같은 걸 dUSD, dKRW를 만든다

## 사이드 체인

- 서광열
- 업그레이드가 어렵다
- 새로운 블록체인을 만들 수 있는 쉬운 방법
  - 합의 알고리듬을 단순화한 프로토콜을 만들어서 이더 결제만 모체인에 의존
  - 입맛에 맞는 블록체인을 만들 수 있으니 여길 공부
- 임병완
  - 요세미티가 한 대의 서버로 돌고 있는 사이드 체인
  - 솔리디티로 dapp 만들 생각 말고 자체 체인을 만드는 기술을 공부하자

## 데브콘3

- 김균태(해쉬드라운지)
  - 프로 엔지니어들이 들어오고 있다.
  - 리플 70%가 한국. 한국 눈치 본다
  - 실리콘 밸리를 앞설 수도 있는 마지막 타이밍
  - SE의 궁극적 모습이다

## 개발자로서 접근 방삭

- 박재현
  - 요세미티 아키텍팅 놀랍다
  - 4차 상넝혁명과 Ai가 한국 개발 세상을 망친다
  - 실제 세상을 바꾸는 건 블록체인이다
- 김균태
  - 소스 코드 실제 보면 기여할 게 많을 거다
- 서광열
  - 솔리디티 컴파일러나 툴링
  - 솔리디티 컴파일러 제일 못 짠..
  - 취직 못한 애들이 짠 거 아니냐..
  - 자바스크립트 1997년을 생각해봐라.. 플랫폼이 웹이니까 뜬다
  - 솔리디티도 마찬가지다. 플랫폼이 무려 블록체인이다
- 임병완
  - 스테이블 코인, 내쇼날 체인이 정말 금융 혁신
- 김균태
  - 러시아, 에스토니아, 일본
  - 국가적으로 블록체인을 관리의 축으로 하면 좋겠..

## 최후 발언

- 임병완
  - 에셋 교환 파급력 크다
- 서광열
  - 베이비체인 오픈소스 프로젝
  - 다음 교육은 스크래치부터 만들어보기
- 김균태
  - 10년에 한 번 씩 기회 온다
  - 화폐 개혁은 1천년에 한 번..
  - 글로벌 발판 되는 기술
- 박재현
  - 탈중앙화, 참여자가 윈윈이다
  - 5G 세상에서 중앙화 된 업체들에게 의존할 필요 있겠냐
- 백재선
  - 탈중앙화
  - 문화가 다르다



















